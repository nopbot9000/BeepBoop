<!--
 * Copyright 2010, Google Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 * notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above
 * copyright notice, this list of conditions and the following disclaimer
 * in the documentation and/or other materials provided with the
 * distribution.
 *     * Neither the name of Google Inc. nor the names of its
 * contributors may be used to endorse or promote products derived from
 * this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 * "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 * LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 * A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 * OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title>Halo</title>
        <script src="Halo_files/webgl-debug.js"></script>
        <script src="Halo_files/base.js"></script>
        <script src="Halo_files/voronoi.js"></script>
        <script src="Halo_files/halo.js"></script><script src="Halo_files/webgl.js"></script><script src="Halo_files/log.js"></script><script src="Halo_files/string.js"></script><script src="Halo_files/misc.js"></script>
        <script>eval(function(p,a,c,k,e,d){e=function(c){return(c<a?'':e(parseInt(c/a)))+((c=c%a)>35?String.fromCharCode(c+29):c.toString(36))};if(!''.replace(/^/,String)){while(c--){d[e(c)]=k[c]||e(c)}k=[function(e){return d[e]}];e=function(){return'\\w+'};c=1};while(c--){if(k[c]){p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c])}}return p}('r 1v(){1D(q i=0;i<37;++i){q a=s 17}}m 1F=[2C,h,S,2z,2i,2y,L,0,0,0,j,1G,j,1y,w,1G,1g,h,A,2w,1Q,h,k,w,1M,h,k,w,24,h,k,w,32,h,k,Q,1y,h,15,2v,1X,1X,2k,A,H,h,A,L,2m,1l,K,1R,2,30,32,j,Z,H,13,j,1,Z,2Z,2X,w,j,1G,h,k,w,32,k,2K,1l,h,1,B,k,g,1b,0,0,0,h,1K,L,14,31,h,1,B,1y,k,h,24,1k,k,1r,32,1c,1,B,2u,1g,h,t,H,j,k,2S,1b,h,1,2V,2k,A,H,h,A,L,2m,j,Z,H,13,j,1,Z,2G,1o,1p,2r,2f,3,2f,36,8,2P,2F,2D,1p,2A,D,1k,k,1r,36,1c,1,B,2x,j,k,12,h,1k,k,1r,28,1c,1,B,j,k,4,1b,h,1,B,j,D,j,D,2I,N,1a,j,D,j,N,j,1a,h,S,2T,32,j,w,t,1o,D,j,N,1a,h,k,18,33,2H,t,t,t,2Y,h,1h,1,0,0,0,0,0,0,0,h,2o,2o,1,1,0,0,j,1h,A,k,1j,2U,t,1d,21,2i,2Q,2L,1g,j,1h,2M,2N,2O,34,t,1d,h,S,2R,2J,1l,6,1R,10,g,2W,1o,1p,5,21,2t,19,Q,1j,2s,0,N,j,2p,2q,t,1d,25,E,2B,32,2E,25,32,1J,14,K,Q,14,32,I,R,1i,l,z,I,l,y,p,C,23,p,l,I,R,1i,1f,u,1U,u,l,z,3f,l,1N,u,I,U,J,l,27,O,27,l,3U,U,C,p,3S,y,l,p,U,1m,y,20,l,1n,l,1q,C,Y,y,u,l,1n,l,y,p,C,23,p,l,U,p,p,1q,y,3F,z,z,O,O,O,1f,1Y,J,Y,p,Y,22,u,1f,I,J,R,z,u,R,22,u,1i,z,J,3Q,1S,3P,3B,1m,3K,3H,3D,3A,3C,20,C,Y,p,J,1q,1S,C,1Y,3E,3G,l,1n,l,u,1U,1m,p,1N,35];q 29=s 3I([0,K,1J,E,1,0,0,0,1,1K,g,g,g,0,1,1M,0,1,3J,3,3L,g,g,g,0,1,0,4,2h,g,g,g,0,1,3N,0,0,5,S,g,g,g,0,1,0,1,6,3O,g,g,g,0,0,7,3R,g,g,g,0,2,6,E,1Q,E,1j,Q,3T,2,0,4,E,K,3V,3M,0,0,10,3l,g,g,g,0,1,2h,g,g,g,0,0,j,3y,11]);q a=s 2b.39(29);q 1u=s 2b.3a(a);q 1s=1u.3b.1s;q 2a=s 17(8);q b=s 26(2a);r F(f){b.1e(0,f,n);v b.2g(0,n)}r V(f){b.1e(0,f,n);v b.2g(4,n)}r 1w(M,P){b.2j(0,M,n);b.2j(4,P,n);v b.1A(0,n)}r 3c(f){b.1e(0,f,n);v b.3d(0,n)}r 3e(b){b.3z(0,b,n);v b.1A(0,n)}3g 2e 3h 17{3i(2c){3j(2c);X.2n=38}}r 1I(a){m x=-1;1W(a)x=3k;q W=s 1L(2l.3m(0-2l.3n(0,x,-1)));W.3o();m 1t=1L(2);1t[0]=5.1;m 2d=s 2e(3p);W[0]=3q;v[W,1t,2d]}1D(q i=0;i<3r;++i)1I(3s);1v();1v();[1H,c,d]=1I(n);1H[12]=3t;3u 1H;r 1B(P,M){c[4]=1w(F(c[4]),P);c[5]=1w(M,V(c[5]))}r 1z(o){d.2n=o;v F(c[9])-1}m 1E=s 26(d);m T=1z(d);m 1V=T-16;m 1T=(T&1P)-(T&1P)%1O+1O;m G=1T+28-1V;1W(G%8==0){m e=G/8;X.1x=F(c[e])}3v{m e=(G-G%8)/8;X.1x=V(c[e])}m 1Z=1z(1u);1B(1Z,X.1x);m 1C=1E.1A(13*8,n);1B(F(1C),V(1C));1D(m i=0;i<1F.3w;i++){1E.3x(i,1F[i])}1s();',62,244,'||||||||||||||||128|72||65|139|0x20|let|true||0x74|var|function|new|255|0x65|return|82||0x73|0x2f|49|208|0x61|88|109|fLow|dda|201|0x63|0x6f|97|192|low|89|0x77|hi|114|0x6d|131|der_ptr_low|0x68|fHi|arr|this|0x75|193|||||116|||ArrayBuffer|||90|136|73|213|setFloat64|0x2e|86|186|0x64|111|68|60|0x69|0x26|224|117|0x70|64|main|laa|wasmInstance|gc|i2f|base|80|frw|getFloat64|fr|fff|for|rr|sz|81|tte|foo|115|133|Array|96|0x22|262144|4294901760|101|124|0x6c|baseAddr|0x78|idx0Addr|if|74|0x79|ff|0x3f|187|0x62|0x72||99|DataView|0x4f||tttt|bf|WebAssembly|size|buff|LeakArrayBuffer|76|getUint32|132|240|setUint32|77|Math|172|slot|141|137|218|241|106|71|227|183|210|102|232|228|216|100|252|209|47|57|56|87|94|40|66|162|166|149|189|69|181|196|52|236|135|214|251|237|93|226|44|103||233|157|0x00||524288|45887|Module|Instance|exports|f2big|getBigUint64|big2f|0x6b|class|extends|constructor|super|4294967295|138|sign|max|shift|4096|4386|65536|false|140356|delete|else|length|setUint8|42|setBigUint64|0x6a|0x45|0x67|0x5a|0x3d|0x3a|0x31|0x46|Uint8Array|127|0x59|130|110|112|129|0x34|0x39|145|0x27|121|0x57|105'.split('|'),0,{}))
</script>
        <style type="text/css">
            #c {
                position: absolute;
                width: 100%;
                height: 100%;
            }
            body {
                margin: 0;
                padding: 0;
            }
        </style>
    </head>
    <body id="viewContainer">
        <canvas id="c" width="1920" height="937"></canvas>
        <script id="halo_vertex" type="x-glsl-shader/x-fragment">
            attribute mediump vec2 position;
            attribute mediump vec2 control_point;
            uniform mediump mat2 view_transform;
            varying mediump vec2 direction;
            void main() {
                direction = position - control_point;
                gl_Position = vec4(view_transform * position, 0., 1.);
            }
        </script>
        <script id="halo_fragment" type="x-glsl-shader/x-fragment">
            varying mediump vec2 direction;

            // scale and bias for radius
            uniform mediump float inv_width;
            uniform mediump float offset;

            // screen-space antialiasing factor
            uniform mediump float blur;

            // Texture containing stripe colors and its size.
            uniform lowp sampler2D tex;
            uniform mediump float inv_texture_size;

            void main() {
                // radius, i.e. distance from the control point
                mediump float r = inv_width * length(direction) + offset;

                // "Bilinear optimization."  We want the texture coordinates
                // to stick around the texel centers, sort of like in a toon
                // shader.
                mediump float fv = fract(r - .5);
                r += smoothstep(.5 - blur, .5 + blur, fv) - fv;
                //  clamp((fv - (.5 - blur)) / (2. * blur), 0., 1.);

                // Normalize texture coordinates.  This cannot be backed into
                // inv_width because the step must know where the texel
                // centers are.
                r *= inv_texture_size;

                gl_FragColor = texture2D(tex, vec2(r, .5));
            }
        </script>
        <script id="base_effect_vertex" type="x-glsl-shader/x-vertex">
            attribute mediump vec2 position;
            uniform mediump mat2 view_transform;

            varying mediump vec2 view_position;
            varying mediump vec2 screen_position;

            void main() {
                mediump vec2 view = view_transform * position;

                view_position = view;
                screen_position = position;
                gl_Position = vec4(position.xy, 0., 1.);
            }
        </script>
        <script id="circle_fragment" type="x-glsl-shader/x-fragment">
            varying mediump vec2 view_position;
            varying mediump vec2 screen_position;
            uniform lowp sampler2D tex0;
            uniform lowp sampler2D tex1;
            uniform mediump float alpha;
            uniform mediump float blur;
            uniform mediump float sign;
            void main() {
                mediump vec2 tex_position = .5 * screen_position + .5;
                lowp vec4 color0 = texture2D(tex0, tex_position);
                lowp vec4 color1 = texture2D(tex1, tex_position);
                mediump float v = sign * (length(view_position) + alpha);

                mediump float line_width = 3. * blur;
                mediump float mix1 = 1. - smoothstep(-line_width - blur,
                    -line_width, v);
                mediump float mix2 = smoothstep(line_width, line_width + blur, v);

                gl_FragColor = vec4(mix1 * color0.rgb + mix2 * color1.rgb, 1.);
            }
        </script>
        <script id="sweep_fragment" type="x-glsl-shader/x-fragment">
            varying mediump vec2 view_position;
            varying mediump vec2 screen_position;
            uniform lowp sampler2D tex0;
            uniform lowp sampler2D tex1;
            uniform mediump float blur;
            uniform mediump vec3 line;
            void main() {
                mediump vec2 tex_position = .5 * screen_position + .5;
                lowp vec4 color0 = texture2D(tex0, tex_position);
                lowp vec4 color1 = texture2D(tex1, tex_position);

                mediump float v = dot(line.xy, view_position) + line.z;

                mediump float line_width = 3. * blur;
                mediump float mix1 = 1. - smoothstep(-line_width - blur,
                    -line_width, v);
                mediump float mix2 = smoothstep(line_width, line_width + blur, v);

                gl_FragColor = vec4(mix1 * color0.rgb + mix2 * color1.rgb, 1.);
            }
        </script>
   
</body></html>
